{"ast":null,"code":"import _slicedToArray from\"/Users/ilyanovik/Documents/Projects/movies-explorer-api-full/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef}from'react';import'./Movies.scss';import SearchForm from'../SearchForm/SearchForm';import MoviesCardList from'../MoviesCardList/MoviesCardList';import*as moviesApi from'../../utils/MoviesApi';import MoviesRequestError from'../MoviesRequestError/MoviesRequestError';import{filterByDuration,filterMovies}from'../../utils/utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Movies(_ref){var onSaveFilm=_ref.onSaveFilm,onDeleteFilm=_ref.onDeleteFilm,savedMovies=_ref.savedMovies;var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),allMovies=_React$useState2[0],setAllMovies=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),filtredMovies=_React$useState4[0],setFiltredMovies=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isShortMovies=_React$useState6[0],setIsShortMovies=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),isLoading=_React$useState8[0],setIsLoading=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),isRequestErr=_React$useState10[0],setIsRequestErr=_React$useState10[1];var _React$useState11=React.useState(false),_React$useState12=_slicedToArray(_React$useState11,2),isNotFound=_React$useState12[0],setIsNotFound=_React$useState12[1];var _React$useState13=React.useState(''),_React$useState14=_slicedToArray(_React$useState13,2),searchQeury=_React$useState14[0],setSearchQeury=_React$useState14[1];var _React$useState15=React.useState([]),_React$useState16=_slicedToArray(_React$useState15,2),initialMovies=_React$useState16[0],setInitialMovies=_React$useState16[1];useEffect(function(){if(localStorage.getItem('filtredMovies')){setFiltredMovies(JSON.parse(localStorage.getItem('filtredMovies')));}if(localStorage.getItem('query')){setSearchQeury(localStorage.getItem('query'));}if(localStorage.getItem('isShort')){setIsShortMovies(JSON.parse(localStorage.getItem('isShort')));}},[]);useEffect(function(){if(filtredMovies.length===0&&searchQeury){setIsNotFound(true);}else{setIsNotFound(false);}},[filtredMovies.length,searchQeury]);function onFilterMovies(movies,query,short){var filtredMoviesData=short?filterByDuration(filterMovies(allMovies,query)):filterMovies(movies,query);setFiltredMovies(filtredMoviesData);localStorage.setItem('filtredMovies',JSON.stringify(filtredMoviesData));}function onShortFilterMovies(){setIsShortMovies(!isShortMovies);localStorage.setItem('isShort',!isShortMovies);onFilterMovies(allMovies,searchQeury,!isShortMovies);}function onSearchMovies(query){setIsLoading(true);setSearchQeury(query);localStorage.setItem('query',query);if(!localStorage.getItem('allMovies')){moviesApi.getMovies(query).then(function(movies){localStorage.setItem('allMovies',JSON.stringify(movies));setIsRequestErr(false);setAllMovies(movies);onFilterMovies(movies,query,isShortMovies);}).catch(function(error){setIsRequestErr(true);console.log(error);});}else if(allMovies.length===0){setIsRequestErr(false);setAllMovies(JSON.parse(localStorage.getItem('allMovies')));}localStorage.setItem('filtredMovies',JSON.stringify(filtredMovies));setIsLoading(false);onFilterMovies(allMovies,query,isShortMovies);}return/*#__PURE__*/_jsxs(\"section\",{className:\"movies\",children:[/*#__PURE__*/_jsx(SearchForm,{onSearchMovies:onSearchMovies,isShortMovies:isShortMovies,onFilter:onShortFilterMovies,query:searchQeury,setQuery:setSearchQeury}),isRequestErr?/*#__PURE__*/_jsx(MoviesRequestError,{}):/*#__PURE__*/_jsx(MoviesCardList,{cards:filtredMovies,isLoading:isLoading,onSaveFilm:onSaveFilm,onDeleteFilm:onDeleteFilm,savedMovies:savedMovies,isNotFound:isNotFound})]});}export default Movies;","map":{"version":3,"names":["React","useEffect","useRef","SearchForm","MoviesCardList","moviesApi","MoviesRequestError","filterByDuration","filterMovies","Movies","onSaveFilm","onDeleteFilm","savedMovies","useState","allMovies","setAllMovies","filtredMovies","setFiltredMovies","isShortMovies","setIsShortMovies","isLoading","setIsLoading","isRequestErr","setIsRequestErr","isNotFound","setIsNotFound","searchQeury","setSearchQeury","initialMovies","setInitialMovies","localStorage","getItem","JSON","parse","length","onFilterMovies","movies","query","short","filtredMoviesData","setItem","stringify","onShortFilterMovies","onSearchMovies","getMovies","then","catch","error","console","log"],"sources":["/Users/ilyanovik/Documents/Projects/movies-explorer-api-full/frontend/src/components/Movies/Movies.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport './Movies.scss';\nimport SearchForm from '../SearchForm/SearchForm';\nimport MoviesCardList from '../MoviesCardList/MoviesCardList';\nimport * as moviesApi from '../../utils/MoviesApi';\nimport MoviesRequestError from '../MoviesRequestError/MoviesRequestError';\nimport { filterByDuration, filterMovies } from '../../utils/utils';\n\nfunction Movies({ onSaveFilm, onDeleteFilm, savedMovies }) {\n  const [allMovies, setAllMovies] = React.useState([]);\n  const [filtredMovies, setFiltredMovies] = React.useState([]);\n  const [isShortMovies, setIsShortMovies] = React.useState(false);\n  const [isLoading, setIsLoading] = React.useState(false);\n  const [isRequestErr, setIsRequestErr] = React.useState(false);\n  const [isNotFound, setIsNotFound] = React.useState(false);\n  const [searchQeury, setSearchQeury] = React.useState('');\n  const [initialMovies, setInitialMovies] = React.useState([]);\n\n  useEffect(() => {\n    if (localStorage.getItem('filtredMovies')) {\n      setFiltredMovies(JSON.parse(localStorage.getItem('filtredMovies')));\n    } \n    if (localStorage.getItem('query')) {\n      setSearchQeury(localStorage.getItem('query'));\n    } \n    if (localStorage.getItem('isShort')) {\n      setIsShortMovies(JSON.parse(localStorage.getItem('isShort')));\n    } \n  }, [])\n\n\n  useEffect(() => {\n    if (filtredMovies.length === 0 && searchQeury) {\n      setIsNotFound(true);\n    } else {\n      setIsNotFound(false);\n    }\n  }, [filtredMovies.length, searchQeury]);\n\n  function onFilterMovies(movies, query, short) {\n    const filtredMoviesData = short\n      ? filterByDuration(filterMovies(allMovies, query))\n      : filterMovies(movies, query);\n    setFiltredMovies(filtredMoviesData);\n    localStorage.setItem('filtredMovies', JSON.stringify(filtredMoviesData));\n  }\n\n  function onShortFilterMovies() {\n    setIsShortMovies(!isShortMovies);\n    localStorage.setItem('isShort', !isShortMovies);\n    onFilterMovies(allMovies, searchQeury, !isShortMovies);\n  }\n\n  function onSearchMovies(query) {\n    setIsLoading(true);\n    setSearchQeury(query);\n    localStorage.setItem('query', query);\n    if (!localStorage.getItem('allMovies')) {\n      moviesApi\n        .getMovies(query)\n        .then((movies) => {\n          localStorage.setItem('allMovies', JSON.stringify(movies));\n          setIsRequestErr(false);\n          setAllMovies(movies);\n          onFilterMovies(movies, query, isShortMovies);\n        })\n        .catch((error) => {\n          setIsRequestErr(true);\n          console.log(error);\n        });\n    } else if (allMovies.length === 0) {\n      setIsRequestErr(false);\n      setAllMovies(JSON.parse(localStorage.getItem('allMovies')));\n    }\n    localStorage.setItem('filtredMovies', JSON.stringify(filtredMovies));\n    setIsLoading(false);\n    onFilterMovies(allMovies, query, isShortMovies);\n  }\n\n  return (\n    <section className=\"movies\">\n      <SearchForm\n        onSearchMovies={onSearchMovies}\n        isShortMovies={isShortMovies}\n        onFilter={onShortFilterMovies}\n        query={searchQeury}\n        setQuery={setSearchQeury}\n      />\n      {isRequestErr ? (\n        <MoviesRequestError />\n      ) : (\n        <MoviesCardList\n          cards={filtredMovies}\n          isLoading={isLoading}\n          onSaveFilm={onSaveFilm}\n          onDeleteFilm={onDeleteFilm}\n          savedMovies={savedMovies}\n          isNotFound={isNotFound}\n        />\n      )}\n    </section>\n  );\n}\n\nexport default Movies;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}