{"ast":null,"code":"import _slicedToArray from\"/Users/ilyanovik/Documents/Projects/movies-explorer-api-full/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useState}from'react';import CurrentUserContext from'../../contexts/CurrentUserContext';import{useFormWithValidation}from'../../utils/utils';import'./Profile.scss';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Profile(_ref){var isLoading=_ref.isLoading,onLogout=_ref.onLogout,onSubmit=_ref.onSubmit,isRequestErr=_ref.isRequestErr,isProfileUpdateSuccess=_ref.isProfileUpdateSuccess;var _useFormWithValidatio=useFormWithValidation(),values=_useFormWithValidatio.values,handleChange=_useFormWithValidatio.handleChange,isValid=_useFormWithValidatio.isValid,resetForm=_useFormWithValidatio.resetForm;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isEditMode=_useState2[0],setIsEditMode=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLastValues=_useState4[0],setIsLastValues=_useState4[1];var currentUser=useContext(CurrentUserContext);function handleSubmit(e){e.preventDefault();onSubmit({name:values.name,email:values.email});setIsEditMode(!isEditMode);}function handleEdit(e){e.preventDefault();setIsEditMode(!isEditMode);}useEffect(function(){resetForm(currentUser);},[currentUser,resetForm]);useEffect(function(){if(currentUser.name===values.name&&currentUser.email===values.email){setIsLastValues(true);}else{setIsLastValues(false);}},[values.name,values.email]);return/*#__PURE__*/_jsxs(\"section\",{className:\"profile\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"profile__greating\",children:[\"Hello, \",currentUser.name||'user',\"!\"]}),/*#__PURE__*/_jsxs(\"form\",{className:\"profile__info\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"fieldset\",{className:\"profile__info-fieldset-wrap\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile__info-item\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"profile__info-item-title\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{readOnly:!isEditMode||isLoading,className:\"profile__info-item-input\",type:\"text\",name:\"name\",onChange:handleChange,required:true,minLength:\"4\",maxLength:\"320\",value:values.name||''})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile__info-item\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"profile__info-item-title\",children:\"E-mail\"}),/*#__PURE__*/_jsx(\"input\",{readOnly:!isEditMode||isLoading,className:\"profile__info-item-input\",type:\"email\",name:\"email\",onChange:handleChange,required:true,minLength:\"4\",maxLength:\"320\",pattern:\"[a-z0-9._%+-]+@[a-z0-9.-]+\\\\.[a-z]{2,4}$\",value:values.email||''})]})]}),isEditMode?/*#__PURE__*/_jsx(\"button\",{className:\"link button profile__edit-submit-button \".concat(!isValid||isLastValues||isLoading?'profile__edit-submit-button_disabled':''),disabled:!isValid||isLastValues||isLoading,children:\"Save\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile__request-answer \".concat(isRequestErr&&'profile__request-error',\" \").concat(isProfileUpdateSuccess&&'profile__request-success',\" \"),children:[isRequestErr&&'Request error',isProfileUpdateSuccess&&'Profile updated']}),/*#__PURE__*/_jsx(\"button\",{className:\"link button profile__edit-button \".concat(isValid?'':'profile__edit-button_disabled'),onClick:handleEdit,children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"link button profile__logout-button\",onClick:onLogout,children:\"Log out\"})]})]})]});}export default Profile;","map":{"version":3,"names":["React","useContext","useEffect","useState","CurrentUserContext","useFormWithValidation","Profile","isLoading","onLogout","onSubmit","isRequestErr","isProfileUpdateSuccess","values","handleChange","isValid","resetForm","isEditMode","setIsEditMode","isLastValues","setIsLastValues","currentUser","handleSubmit","e","preventDefault","name","email","handleEdit"],"sources":["/Users/ilyanovik/Documents/Projects/movies-explorer-api-full/frontend/src/components/Profile/Profile.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport CurrentUserContext from '../../contexts/CurrentUserContext';\nimport { useFormWithValidation } from '../../utils/utils';\nimport './Profile.scss';\n\nfunction Profile({ isLoading, onLogout, onSubmit, isRequestErr, isProfileUpdateSuccess }) {\n  const { values, handleChange, isValid, resetForm } = useFormWithValidation();\n  const [isEditMode, setIsEditMode] = useState(false);\n  const [isLastValues, setIsLastValues] = useState(false);\n  const currentUser = useContext(CurrentUserContext);\n\n  function handleSubmit(e) {\n    e.preventDefault();\n    onSubmit({\n      name: values.name,\n      email: values.email,\n    });\n    setIsEditMode(!isEditMode);\n  }\n\n  function handleEdit(e) {\n    e.preventDefault();\n    setIsEditMode(!isEditMode);\n  }\n\n  useEffect(() => {\n    resetForm(currentUser);\n  }, [currentUser, resetForm]);\n\n  useEffect(() => {\n    if (currentUser.name === values.name && currentUser.email === values.email) {\n      setIsLastValues(true);\n    } else {\n      setIsLastValues(false);\n    }\n  }, [values.name, values.email]);\n\n  return (\n    <section className=\"profile\">\n      <h2 className=\"profile__greating\">Hello, {currentUser.name || 'user'}!</h2>\n      <form className=\"profile__info\" onSubmit={handleSubmit}>\n        <fieldset className=\"profile__info-fieldset-wrap\">\n          <div className=\"profile__info-item\">\n            <label className=\"profile__info-item-title\">Name</label>\n            <input\n              readOnly={!isEditMode || isLoading}\n              className=\"profile__info-item-input\"\n              type=\"text\"\n              name=\"name\"\n              onChange={handleChange}\n              required\n              minLength=\"4\"\n              maxLength=\"320\"\n              value={values.name || ''}></input>\n          </div>\n          <div className=\"profile__info-item\">\n            <label className=\"profile__info-item-title\">E-mail</label>\n            <input\n              readOnly={!isEditMode || isLoading}\n              className=\"profile__info-item-input\"\n              type=\"email\"\n              name=\"email\"\n              onChange={handleChange}\n              required\n              minLength=\"4\"\n              maxLength=\"320\"\n              pattern=\"[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$\"\n              value={values.email || ''}></input>\n          </div>\n        </fieldset>\n        {isEditMode ? (\n          <button\n            className={`link button profile__edit-submit-button ${\n              !isValid || isLastValues || isLoading ? 'profile__edit-submit-button_disabled' : ''\n            }`}\n            disabled={!isValid || isLastValues || isLoading}>\n            Save\n          </button>\n        ) : (\n          <>\n            <div\n              className={`profile__request-answer ${isRequestErr && 'profile__request-error'} ${\n                isProfileUpdateSuccess && 'profile__request-success'\n              } `}>\n              {isRequestErr && 'Request error'}{isProfileUpdateSuccess && 'Profile updated'}\n            </div>\n            <button\n              className={`link button profile__edit-button ${\n                isValid ? '' : 'profile__edit-button_disabled'\n              }`}\n              onClick={handleEdit}>\n              Edit\n            </button>\n            <button className=\"link button profile__logout-button\" onClick={onLogout}>\n              Log out\n            </button>\n          </>\n        )}\n      </form>\n    </section>\n  );\n}\n\nexport default Profile;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}